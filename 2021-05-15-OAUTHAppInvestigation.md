OAUTH Apps pose a serious risk to the organizations nowadays due to the
volume of applications and their permissions. Please find below the
guideline for investigation and prevention of OAUTH App risks.

 

1.  We can use Microsoft Cloud App Security (MCAS) to search for the
    applications and their permissions. Then you can also search who
    provided Consent to the application. Either you can go to the
    respective application and look for the consent activities or use
    the Activity log in MCAS.  

 

MCAS- Specific OAUTH App.

> ![](media/image1.jpeg){width="6.5in" height="3.738888888888889in"}

 

MCAS- Activity Log

![](media/image2.jpeg){width="6.5in" height="4.052083333333333in"}

 

 

 

 

2.  You can also search directly in Azure AD Audit Log (by filtering in
    Action) , but they will be typically available only for last 30 days
    unless you are storing them separately in LA workspace using
    diagnostic settings.

3.  Regarding Investigation, You can use some of the saved queries in
    MCAS like "Apps authorized by external users" etc to start with. 
    Also, you can look for applications with shield symbol in
    "Authorized by" column which indicates "Admin consent for all users
    in the organization to use this application".   Reference-
    [[https://docs.microsoft.com/en-us/cloud-app-security/investigate-risky-oauth]{.ul}](https://docs.microsoft.com/en-us/cloud-app-security/investigate-risky-oauth)

 

![](media/image3.jpeg){width="6.5in" height="4.403472222222222in"}

 

4.  Regrading Permission review, It is recommended to review  all apps
    with  "High " category in MCAS . But if you want to further drill
    down and target one by one, then you can search for key words like
    "Full", "Directory" and "All" . Those may indicate some of the
    sensitive permissions for all users.

 

![](media/image4.jpeg){width="5.581498250218723in"
height="3.3423392388451445in"}

 

![](media/image5.jpeg){width="5.061674321959755in"
height="3.0624212598425196in"}

** **

![](media/image6.jpeg){width="4.960352143482065in"
height="2.9677318460192477in"}

** **

5.  Regarding Prevention, below are the recommended options for
    prevention.

```{=html}
<!-- -->
```
A.  Monitor OAuth App Alerts generated by MCAS using SIEM and take
    > necessary action to block them if applicable. Create custom Alert
    > in MCAS to detect deployment of any OAUTH app for specific use
    > case .  Reference-
    > [[https://docs.microsoft.com/en-us/cloud-app-security/app-permission-policy]{.ul}](https://docs.microsoft.com/en-us/cloud-app-security/app-permission-policy)

B.  Integrate with MDE/MDATP and block the app using MDE

> Note: MDE needs some prerequisite like Network Protection and Defender
> AV etc. Refer-
> [[https://techcommunity.microsoft.com/t5/security-compliance-identity/block-access-to-unsanctioned-apps-with-microsoft-defender-atp/ba-p/1121179]{.ul}](https://techcommunity.microsoft.com/t5/security-compliance-identity/block-access-to-unsanctioned-apps-with-microsoft-defender-atp/ba-p/1121179)

C.  Implement Consent Management in the Azure AD. 

> Consent Management is done in Azure AD and may need some workflow
> process depending on the process you want to follow.  Reference-
> [[https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/manage-consent-requests]{.ul}](https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/manage-consent-requests)
